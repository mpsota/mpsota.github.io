{
"version":3,
"file":"module$node_modules$web3_eth_ens$src$lib$ResolverMethodHandler.js",
"lineCount":6,
"mappings":"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",
"sources":["node_modules/web3-eth-ens/src/lib/ResolverMethodHandler.js"],
"sourcesContent":["shadow$provide[\"module$node_modules$web3_eth_ens$src$lib$ResolverMethodHandler\"] = function(global,require,module,exports) {\n/*\n    This file is part of web3.js.\n    web3.js is free software: you can redistribute it and/or modify\n    it under the terms of the GNU Lesser General Public License as published by\n    the Free Software Foundation, either version 3 of the License, or\n    (at your option) any later version.\n    web3.js is distributed in the hope that it will be useful,\n    but WITHOUT ANY WARRANTY; without even the implied warranty of\n    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n    GNU Lesser General Public License for more details.\n    You should have received a copy of the GNU Lesser General Public License\n    along with web3.js.  If not, see <http://www.gnu.org/licenses/>.\n*/\n/**\n * @file ResolverMethodHandler.js\n *\n * @author Samuel Furter <samuel@ethereum.org>\n * @date 2018\n */\n\n\"use strict\";\n\nvar PromiEvent = require('web3-core-promievent');\nvar namehash = require('eth-ens-namehash');\nvar _ = require('underscore');\n\n/**\n * @param {Registry} registry\n * @constructor\n */\nfunction ResolverMethodHandler(registry) {\n    this.registry = registry;\n}\n\n/**\n * Executes an resolver method and returns an eventifiedPromise\n *\n * @param {string} ensName\n * @param {string} methodName\n * @param {array} methodArguments\n * @param {function} callback\n * @returns {Object}\n */\nResolverMethodHandler.prototype.method = function (ensName, methodName, methodArguments, callback) {\n    return {\n        call: this.call.bind({\n            ensName: ensName,\n            methodName: methodName,\n            methodArguments: methodArguments,\n            callback: callback,\n            parent: this\n        }),\n        send: this.send.bind({\n            ensName: ensName,\n            methodName: methodName,\n            methodArguments: methodArguments,\n            callback: callback,\n            parent: this\n        })\n    };\n};\n\n/**\n * Executes call\n *\n * @returns {eventifiedPromise}\n */\nResolverMethodHandler.prototype.call = function (callback) {\n    var self = this;\n    var promiEvent = new PromiEvent();\n    var preparedArguments = this.parent.prepareArguments(this.ensName, this.methodArguments);\n\n    this.parent.registry.resolver(this.ensName).then(function (resolver) {\n        self.parent.handleCall(promiEvent, resolver.methods[self.methodName], preparedArguments, callback);\n    }).catch(function (error) {\n        promiEvent.reject(error);\n    });\n\n    return promiEvent.eventEmitter;\n};\n\n\n/**\n * Executes send\n *\n * @param {Object} sendOptions\n * @param {function} callback\n * @returns {eventifiedPromise}\n */\nResolverMethodHandler.prototype.send = function (sendOptions, callback) {\n    var self = this;\n    var promiEvent = new PromiEvent();\n    var preparedArguments = this.parent.prepareArguments(this.ensName, this.methodArguments);\n\n    this.parent.registry.resolver(this.ensName).then(function (resolver) {\n        self.parent.handleSend(promiEvent, resolver.methods[self.methodName], preparedArguments, sendOptions, callback);\n    }).catch(function (error) {\n        promiEvent.reject(error);\n    });\n\n    return promiEvent.eventEmitter;\n};\n\n/**\n * Handles a call method\n *\n * @param {eventifiedPromise} promiEvent\n * @param {function} method\n * @param {array} preparedArguments\n * @param {function} callback\n * @returns {eventifiedPromise}\n */\nResolverMethodHandler.prototype.handleCall = function (promiEvent, method, preparedArguments, callback) {\n    method.apply(this, preparedArguments).call()\n        .then(function (receipt) {\n            promiEvent.resolve(receipt);\n\n            if (_.isFunction(callback)) {\n                callback(receipt);\n            }\n        }).catch(function (error) {\n            promiEvent.reject(error);\n\n            if (_.isFunction(callback)) {\n                callback(error);\n            }\n        });\n\n    return promiEvent;\n};\n\n/**\n * Handles a send method\n *\n * @param {eventifiedPromise} promiEvent\n * @param {function} method\n * @param {array} preparedArguments\n * @param {Object} sendOptions\n * @param {function} callback\n * @returns {eventifiedPromise}\n */\nResolverMethodHandler.prototype.handleSend = function (promiEvent, method, preparedArguments, sendOptions, callback) {\n    method.apply(this, preparedArguments).send(sendOptions)\n        .on('transactionHash', function (hash) {\n            promiEvent.eventEmitter.emit('transactionHash', hash);\n        })\n        .on('confirmation', function (confirmationNumber, receipt) {\n            promiEvent.eventEmitter.emit('confirmation', confirmationNumber, receipt);\n        })\n        .on('receipt', function (receipt) {\n            promiEvent.eventEmitter.emit('receipt', receipt);\n            promiEvent.resolve(receipt);\n\n            if (_.isFunction(callback)) {\n                callback(receipt);\n            }\n        })\n        .on('error', function (error) {\n            promiEvent.eventEmitter.emit('error', error);\n            promiEvent.reject(error);\n\n            if (_.isFunction(callback)) {\n                callback(error);\n            }\n        });\n\n    return promiEvent;\n};\n\n/**\n * Adds the ENS node to the arguments\n *\n * @param {string} name\n * @param {array} methodArguments\n * @returns {array}\n */\nResolverMethodHandler.prototype.prepareArguments = function (name, methodArguments) {\n    var node = namehash.hash(name);\n\n    if (methodArguments.length > 0) {\n        methodArguments.unshift(node);\n\n        return methodArguments;\n    }\n\n    return [node];\n};\n\nmodule.exports = ResolverMethodHandler;\n\n};"],
"names":["shadow$provide","global","require","module","exports","ResolverMethodHandler","registry","PromiEvent","namehash","_","prototype","method","ResolverMethodHandler.prototype.method","ensName","methodName","methodArguments","callback","call","bind","parent","send","ResolverMethodHandler.prototype.call","self","promiEvent","preparedArguments","prepareArguments","resolver","then","handleCall","methods","catch","error","reject","eventEmitter","ResolverMethodHandler.prototype.send","sendOptions","handleSend","ResolverMethodHandler.prototype.handleCall","apply","receipt","resolve","isFunction","ResolverMethodHandler.prototype.handleSend","on","hash","emit","confirmationNumber","ResolverMethodHandler.prototype.prepareArguments","name","node","length","unshift"]
}
